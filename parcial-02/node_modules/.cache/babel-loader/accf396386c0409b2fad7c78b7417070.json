{"remainingRequest":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/babel-loader/lib/index.js!/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/src/components/PerfilEditar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/src/components/PerfilEditar.vue","mtime":1605737550000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/babel.config.js","mtime":1604343550000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/cache-loader/dist/cjs.js","mtime":1673909588044},{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/babel-loader/lib/index.js","mtime":1673909576330},{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/cache-loader/dist/cjs.js","mtime":1673909588044},{"path":"/Applications/XAMPP/xamppfiles/htdocs/Parcial-02_Progra-III-CW_2020/parcial-02/node_modules/vue-loader/lib/index.js","mtime":1673909584926}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHN0b3JlIGZyb20gIkAvc3RvcmUiOwppbXBvcnQgQmFzZU5vdGlmaWNhY2lvbiBmcm9tICJAL2NvbXBvbmVudHMvQmFzZU5vdGlmaWNhY2lvbiI7CmltcG9ydCBTcGlubmVyTG9hZGVyIGZyb20gIkAvY29tcG9uZW50cy9TcGlubmVyTG9hZGVyIjsKaW1wb3J0IFVzZXJzU2VydmljZSBmcm9tICJAL3NlcnZpY2VzL3VzZXJzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQZXJmaWxFZGl0YXIiLAogIGNvbXBvbmVudHM6IHsKICAgIEJhc2VOb3RpZmljYWNpb24sCiAgICBTcGlubmVyTG9hZGVyCiAgfSwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBzdG9yZSwKICAgICAgZXN0YUNhcmdhbmRvOiBmYWxzZSwKICAgICAgZWRpdGFyVXNlcjogZmFsc2UsCiAgICAgIHVzdWFyaW9zOiBbXSwKICAgICAgdXN1YXJpbzogewogICAgICAgIHVzdWFyaW86IG51bGwsCiAgICAgICAgaW1hZ2VuOiBudWxsCiAgICAgIH0sCiAgICAgIGVycm9yZXM6IHsKICAgICAgICB1c3VhcmlvOiBudWxsCiAgICAgIH0sCiAgICAgIHN0YXR1czogewogICAgICAgIHRpdHVsbzogbnVsbCwKICAgICAgICBtZW5zYWplOiBudWxsLAogICAgICAgIHRpcG86ICdpbmZvJwogICAgICB9CiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIG1ldGhvZHM6IHsKICAgIGdyYWJhcjogZnVuY3Rpb24gKHVzdWFyaW8pIHsKICAgICAgaWYgKHRoaXMuZXN0YUNhcmdhbmRvKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdGhpcy5lc3RhQ2FyZ2FuZG8gPSB0cnVlOwogICAgICBVc2Vyc1NlcnZpY2UuZWRpdCh1c3VhcmlvLmlkLCB1c3VhcmlvKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcyAhPT0gZmFsc2UpIHsKICAgICAgICAgIHRoaXMuZXN0YUNhcmdhbmRvID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmVycm9yZXMgPSB7CiAgICAgICAgICAgIHVzdWFyaW86IG51bGwKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLnN0b3JlLnNldFN0YXR1cyh7CiAgICAgICAgICAgIHRpdHVsbzogIsOJeGl0byIsCiAgICAgICAgICAgIG1lbnNhamU6ICJFbCB1c3VhcmlvIHNlIGVkaXTDsyBleGl0b3NhbWVudGUuIiwKICAgICAgICAgICAgdGlwbzogInN1Y2Nlc3MiCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc3RvcmUuYXV0aCA9IHsKICAgICAgICAgICAgaWQ6IHJlcy5kYXRhLmlkLAogICAgICAgICAgICBlbWFpbDogcmVzLmRhdGEuZW1haWwsCiAgICAgICAgICAgIHVzdWFyaW86IHJlcy5kYXRhLnVzdWFyaW8sCiAgICAgICAgICAgIGltYWdlbjogcmVzLmRhdGEuaW1hZ2VuCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCBKU09OLnN0cmluZ2lmeSh0aGlzLnN0b3JlLmF1dGgpKTsKICAgICAgICAgIHRoaXMuJGVtaXQoJ2NsaWNrJywgdGhpcy5lZGl0YXJVc2VyKTsKICAgICAgICAgIHRoaXMuc3RvcmUuY2xlYXJTdGF0dXMoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHR5cGVvZiByZXMuZXJyb3JlcyA9PSAnb2JqZWN0JykgewogICAgICAgICAgICB0aGlzLmVycm9yZXMgPSByZXMuZXJyb3JlczsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuc3RhdHVzLnRpdHVsbyA9ICJFcnJvciI7CiAgICAgICAgICB0aGlzLnN0YXR1cy5tZW5zYWplID0gIk9jdXJyacOzIHVuIGVycm9yIGFsIHRyYXRhciBkZSBlZGl0YXIgZWwgdXN1YXJpby4iOwogICAgICAgICAgdGhpcy5zdGF0dXMudGlwbyA9ICJkYW5nZXIiOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgY29uc3QgaWQgPSBzdG9yZS5hdXRoLmlkOwogICAgVXNlcnNTZXJ2aWNlLmdldEJ5UGsoaWQpLnRoZW4oZGF0YSA9PiB7CiAgICAgIHRoaXMudXN1YXJpbyA9IGRhdGE7CiAgICB9KTsKICB9Cn07"},{"version":3,"mappings":"AAoDA;AACA;AACA;AACA;AAEA;EACAA;EACAC;IAAAC;IAAAC;EAAA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;QACAA;QACAC;MACA;MACAC;QACAF;MACA;MACAG;QACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;EACAC;IACAC;MACA;QACA;MACA;MACA;MAEAC,aACAC,0BACAC;QACA;UACA;UACA;YACAZ;UACA;UACA;YACAI;YACAC;YACAC;UACA;UACA;YACAO;YACAC;YACAd;YACAC;UACA;UACAc;UAEA;UACA;QACA;UACA;YACA;UACA;UACA;UACA;UACA;QACA;MACA,EACA;IACA;EACA;EACAC;IACA;IACAN,aACAO,YACAL;MACA;IACA;EACA;AACA","names":["name","components","BaseNotificacion","SpinnerLoader","data","store","estaCargando","editarUser","usuarios","usuario","imagen","errores","status","titulo","mensaje","tipo","computed","methods","grabar","UsersService","edit","then","id","email","localStorage","mounted","getByPk"],"sourceRoot":"src/components","sources":["PerfilEditar.vue"],"sourcesContent":["<template>\r\n  <div class=\"col-12 col-md-12 col-lg\">\r\n    <div class=\"row  rounded border p-3 mb-5 mb-md-5 mr-lg-5 bg-light\">\r\n      <BaseNotificacion\r\n          :titulo=\"status.titulo\"\r\n          :mensaje=\"status.mensaje\"\r\n          :tipo=\"status.tipo\"\r\n          v-if=\"status.mensaje != null\"\r\n      />\r\n\r\n      <SpinnerLoader v-if=\"estaCargando\"/>\r\n\r\n      <div class=\"col-12 col-md col-lg bg-light\">\r\n        <h3 class=\"bg-light\">Edita tus datos personales</h3>\r\n        <form action=\"#\"\r\n              id=\"form-login\"\r\n              method=\"POST\"\r\n              @submit.prevent=\"grabar(usuario)\"\r\n        >\r\n          <div class=\"form-group\">\r\n            <label for=\"usuario\"\r\n                   class=\"sr-only\">Modifica tu nombre de usuario\r\n            </label>\r\n            <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                id=\"usuario\"\r\n                placeholder=\"Modifica tu nombre de usuario\"\r\n                v-model=\"usuario.usuario\"\r\n                :disabled=\"estaCargando\"\r\n                :aria-describedby=\"errores.usuario != null ? 'usuario-error' : ''\">\r\n            <div\r\n                id=\"usuario-error\"\r\n                class=\"invalid-feedback\"\r\n                v-if=\"errores.usuario != null\"\r\n                :style=\"errores.usuario != null ? 'display: block' : 'display: none'\"\r\n            >\r\n              {{ errores.usuario[0] }}\r\n            </div>\r\n          </div>\r\n          <button\r\n              type=\"submit\"\r\n              class=\"btn btn-primary float-right\"\r\n          >Confirmar edición\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport store from \"@/store\";\r\nimport BaseNotificacion from \"@/components/BaseNotificacion\";\r\nimport SpinnerLoader from \"@/components/SpinnerLoader\";\r\nimport UsersService from \"@/services/users\";\r\n\r\nexport default {\r\n  name: \"PerfilEditar\",\r\n  components: {BaseNotificacion, SpinnerLoader},\r\n  data: function () {\r\n    return {\r\n      store,\r\n      estaCargando: false,\r\n      editarUser: false,\r\n      usuarios: [],\r\n      usuario: {\r\n        usuario: null,\r\n        imagen: null,\r\n      },\r\n      errores: {\r\n        usuario: null,\r\n      },\r\n      status: {\r\n        titulo: null,\r\n        mensaje: null,\r\n        tipo: 'info'\r\n      }\r\n    }\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    grabar: function (usuario) {\r\n      if (this.estaCargando) {\r\n        return null;\r\n      }\r\n      this.estaCargando = true;\r\n\r\n      UsersService\r\n          .edit(usuario.id, usuario)\r\n          .then(res => {\r\n                if (res !== false) {\r\n                  this.estaCargando = false;\r\n                  this.errores = {\r\n                    usuario: null,\r\n                  };\r\n                  this.store.setStatus({\r\n                    titulo: \"Éxito\",\r\n                    mensaje: \"El usuario se editó exitosamente.\",\r\n                    tipo: \"success\",\r\n                  });\r\n                  this.store.auth = {\r\n                    id: res.data.id,\r\n                    email: res.data.email,\r\n                    usuario: res.data.usuario,\r\n                    imagen: res.data.imagen,\r\n                  };\r\n                  localStorage.setItem('user', JSON.stringify(this.store.auth));\r\n\r\n                  this.$emit('click', this.editarUser);\r\n                  this.store.clearStatus();\r\n                } else {\r\n                  if (typeof res.errores == 'object') {\r\n                    this.errores = res.errores;\r\n                  }\r\n                  this.status.titulo = \"Error\";\r\n                  this.status.mensaje = \"Ocurrió un error al tratar de editar el usuario.\";\r\n                  this.status.tipo = \"danger\";\r\n                }\r\n              }\r\n          );\r\n    }\r\n  },\r\n  mounted() {\r\n    const id = store.auth.id;\r\n    UsersService\r\n        .getByPk(id)\r\n        .then(data => {\r\n          this.usuario = data;\r\n        });\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}